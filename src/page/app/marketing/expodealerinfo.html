<!--
 * 文件描述：收集用户信息-信息填写页
 * 创建人：卢信桥
 * 创建时间：2021-10-15
-->
<html>
<head>
    <title>澜渟</title>
    <style>
        #main {
            height: 7.48rem;
            background: url("/src/assets/img/marketing/bg.png") no-repeat center center;
            background-size: 100% 100%;
            overflow: hidden;
        }
        #logo {
            margin: 0.1rem 0 0 0.06rem;
            width: 1.5rem; height: 0.62rem;
            background: url("/src/assets/img/marketing/logo.png") no-repeat center center;
            background-size: 100% 100%;
        }
        #title {
            margin: 0.01rem auto 0 auto;
            width: 3rem; height: 0.82rem;
            background: url("/src/assets/img/marketing/title.png") no-repeat center center;
            background-size: 100% 100%;
        }
        #condition {
            margin: auto; padding: 0.26rem 0 0 0.11rem;
            width: 3.19rem; height: 3.76rem;
            background-image: linear-gradient(0deg, #0095f3 0%, #48b4f9 50%, #8fd3ff 100%), 
                              linear-gradient(#dbf1ff, #dbf1ff);
            box-shadow: -1px 21px 15px 0px #5eadd5;
            border: 0.01rem solid #ddd;
            border-radius: 0.1rem;
        }
        #name-sex-condition {
            display: flex;
            justify-content: space-between; align-items: center;
            height: 0.2rem;
        }
        #name-condition {
            display: flex;
            align-items: center;
            height: 0.2rem;
        }
        #name-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #name-condition>.text {
            padding: 0 0.05rem;
            width: 0.89rem; height: 0.2rem;
            border: none;
            border-radius: 0.05rem;
            font-size: 0.15rem;
        }
        #sex-condition {
            display: flex;
            align-items: center;
            margin-right: 0.16rem;
            height: 0.2rem;
        }
        #sex-condition>.label {
            font-size: 0.15rem;
            color: #fff;
        }
        #sex-condition>.radio {
            display: flex;
        }
        #sex-condition>.radio>.radio-item {
            display: flex;
            align-items: center;
        }
        #sex-condition>.radio>.radio-item>img {
            margin-top: 0.04rem;
            width: 0.08rem; height: 0.08rem;
        }
        #sex-condition>.radio>.radio-item>span {
            margin-left: 0.04rem;
            color: #fff;
            font-size: 0.15rem;
        }
        #phone-condition {
            display: flex;
            align-items: center;
            margin-top: 0.11rem;
            height: 0.2rem;
        }
        #phone-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #phone-condition>.text {
            padding: 0 0.05rem;
            width: 2.08rem; height: 0.2rem;
            border: none;
            border-radius: 0.05rem;
            font-size: 0.15rem;
        }
        #company-condition {
            display: flex;
            align-items: center;
            margin-top: 0.11rem;
            height: 0.2rem;
        }
        #company-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #company-condition>.text {
            display: flex;
            align-items: center;
            padding: 0 0.05rem;
            width: 2.08rem; height: 0.2rem;
            line-height: 0.2rem;
            border: none;
            border-radius: 0.05rem;
            font-size: 0.15rem;
        }
        #idCard-condition {
            display: flex;
            margin-top: 0.14rem;
            height: 0.36rem;
        }
        #idCard-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #idCard-condition>.radio {
            height: 0.36rem;
        }
        #idCard-condition>.radio>.radio-item {
            display: flex;
            align-items: center;
            padding: 0 0.05rem;
            height: 0.14rem;
        }
        #idCard-condition>.radio>.radio-item>img {
            width: 0.08rem; height: 0.08rem;
        }
        #idCard-condition>.radio>.radio-item>span {
            margin-left: 0.04rem;
            color: #fff;
            font-size: 0.15rem;
        }
        #business-condition {
            display: flex;
            align-items: center;
            margin-top: 0.12rem;
            height: 0.2rem;
        }
        #business-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #business-condition>.text {
            padding: 0 0.05rem;
            width: 2.08rem; height: 0.2rem;
            border: none;
            border-radius: 0.05rem;
            font-size: 0.15rem;
        }
        #product-condition {
            margin-top: 0.14rem;
            height: 1.16rem;
        }
        #product-condition>.label {
            height: 0.15rem;
            line-height: 0.15rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #product-condition>.checkbox {
            margin: 0.04rem 0 0 0.75rem;
            height: 1rem;
            overflow: hidden;
        }
        #product-condition>.checkbox>.checkbox-item {
            margin-bottom: 0.1rem;
            height: 0.14rem;
        }
        #product-condition>.checkbox>.checkbox-item>img {
            width: 0.08rem; height: 0.08rem;
        }
        #product-condition>.checkbox>.checkbox-item>span {
            margin-left: 0.02rem;
            color: #fff;
            font-size: 0.15rem;
        }
        #area-condition {
            display: flex;
            margin-top: 0.12rem;
            height: 0.2rem;
        }
        #area-condition>.label {
            height: 0.2rem;
            line-height: 0.2rem;
            font-size: 0.15rem;
            color: #fff;
        }
        #area-condition>.select {
            width: 1.56rem; height: 0.2rem;
            text-align: center; line-height: 0.2rem;
            border-radius: 0.02rem;
            background-color: #fff; color: #999;
        }
        #submit {
            margin: 0.3rem auto 0 auto; padding-left: 0.1rem;
            width: 1.12rem; height: 0.34rem;
            text-align: center; line-height: 0.34rem;
            border-radius: 0.44rem;
	        letter-spacing: 0.1rem;
            font-size: 0.22rem; font-weight: bold;
            color: #eee;
            background-image: linear-gradient(to bottom, #32a7f0,#ddd);
            box-shadow: -1px 5px 9px rgba(2, 105, 234, 0.93);
            text-shadow: 0px 2px 3px rgba(62, 122, 198, 0.93);
        }
        #secret-title {
            margin-top: 0.46rem;
            height: 0.14rem;
            text-align: center; line-height: 0.14rem;
            font-size: 0.15rem; font-weight: normal;
            color: #ddd;
        }
        #secret-content {
            margin: 0.14rem auto 0 auto;
            width: 3.21rem; height: 0.53rem;
	        font-size: 0.12rem;
	        line-height: 0.14rem;
            color: #666;
        }
        #shade {
            display: none;
            position: fixed;
            top: 0; bottom: 0; left: 0; right: 0;
            background-color: rgba(0, 0, 0, 0);
        }
        #area {
            position: absolute;
            bottom: -3rem; left: 0; right: 0;
            height: 3rem;
            border-top-left-radius: 0.1rem; border-top-right-radius: 0.1rem;
            background-color: #fff;
        }
        #area-title {
            height: 0.4rem;
            text-align: center; line-height: 0.4rem;
            font-size: 0.14rem;
        }
        #area-cancel {
            position: absolute;
            top: 0; left: 0;
            width: 0.6rem; height: 0.4rem;
            background: none; color: #888;
        }
        #area-confirm {
            position: absolute;
            top: 0; right: 0;
            width: 0.6rem; height: 0.4rem;
            background: none; color:rgb(23, 127, 253);
        }
        #area-content {
            display: flex;
            justify-content: space-between;
            height: 2.6rem;
        }
        #area-province {
            flex: 1;
            height: 2.6rem;
            overflow: auto;
        }
        #area-city {
            flex: 1;
            height: 2.6rem;
            overflow: auto;
        }
        .province-item {
            padding-right: 0.2rem;
            height: 0.3rem;
            text-align: right; line-height: 0.3rem;
        }
        .province-item.active {
            font-weight: bold;
            color: rgba(2, 105, 234, 0.93);
        }
        .city-item {
            padding-left: 0.2rem;
            height: 0.3rem;
            line-height: 0.3rem;
        }
        .city-item.active {
            font-weight: bold;
            color: rgba(2, 105, 234, 0.93);
        }

        .shadein {
            animation-name: shadeinAnimate;
            animation-duration: 0.3s;
            animation-fill-mode: forwards;
        }
        @keyframes shadeinAnimate {
            from  {
                background-color: rgba(0, 0, 0, 0);
            }
            to {
                background-color: rgba(0, 0, 0, 0.6);
            }
        }
        .popup {
            animation-name: popupAnimate;
            animation-duration: 0.3s;
            animation-fill-mode: forwards;
        }
        @keyframes popupAnimate {
            from  {
                bottom: -3rem;
            }
            to {
                bottom: 0;
            }
        }
        .popdown {
            animation-name: popdownAnimate;
            animation-duration: 0.3s;
            animation-fill-mode: forwards;
        }
        @keyframes popdownAnimate {
            from  {
                bottom: 0;
            }
            to {
                bottom: -3rem;
            }
        }

        #tip {
            display: none;
            position: fixed; z-index: 99;
            top: 0; bottom: 0; left: 0; right: 0;
            margin: auto;
            width: 2rem; height: 0.36rem;
            text-align: center; line-height: 0.36rem;
            border-radius: 0.36rem;
            font-size: 0.16rem;
            background-color:rgba(0, 0, 0); color: #fff;
        }
    </style>
</head>
<body>
    <div id='main'>
        <div id='logo'></div>
        <div id='title'></div>
        <div id='condition'>
            <div id='name-sex-condition'>
                <div id='name-condition'>
                    <label class='label'>姓名：</label>
                    <input type='text' class='text'/>
                </div>
                <div id='sex-condition'>
                    <label class='label'>性别：</label>
                    <div class='radio' id='sex-condition-radio'>
                        <div class='radio-item male' onclick='checkSex("male")'>
                            <img src='/src/assets/img/marketing/check-one-no.png'>
                            <span>男</span>
                        </div>
                        <div class='radio-item female' onclick='checkSex("female")' style='margin-left: 0.18rem;'>
                            <img src='/src/assets/img/marketing/check-one-no.png'>
                            <span>女</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id='phone-condition'>
                <label class='label'>手机号码：</label>
                <input type='number' class='text' oninput='this.value=this.value.slice(0,11)'/>
            </div>
            <div id='company-condition'>
                <label class='label'>您的公司：</label>
                <input type='text' class='text'/>
            </div>
            <div id='idCard-condition'>
                <label class='label'>您的身份：</label>
                <div class='radio' id='idCard-condition-radio'>
                    <div class='radio-item agent' onclick='checkIdCard("agent")'>
                        <img src='/src/assets/img/marketing/check-one-no.png'>
                        <span>相关领域的经销商</span>
                    </div>
                    <div class='radio-item shop' onclick='checkIdCard("shop")' style='margin-top: 0.08rem;'>
                        <img src='/src/assets/img/marketing/check-one-no.png'>
                        <span>机构门店的负责人</span>
                    </div>
                </div>
            </div>
            <div id='business-condition'>
                <label class='label'>主营业务：</label>
                <input type='text' class='text'/>
            </div>
            <div id='product-condition'>
                <label class='label'>感兴趣的产品：</label>
                <div class='checkbox' id='product-condition-checkbox'>
                    <div class='checkbox-item xfy' value='1' onclick='checkProduct("xfy")'>
                        <img src='/src/assets/img/marketing/check-some-no.png'>
                        <span>盆底肌修复仪(非医疗版)</span>
                    </div>
                    <div class='checkbox-item fky' value='2' onclick='checkProduct("fky")'>
                        <img src='/src/assets/img/marketing/check-some-no.png'>
                        <span>盆底生物刺激反馈仪(医疗)</span>
                    </div>
                    <div class='checkbox-item kegel' value='3' onclick='checkProduct("kegel")'>
                        <img src='/src/assets/img/marketing/check-some-no.png'>
                        <span>凯格尔球</span>
                    </div>
                    <div class='checkbox-item wireless' value='4' onclick='checkProduct("wireless")'>
                        <img src='/src/assets/img/marketing/check-some-no.png'>
                        <span>无线产后恢复仪</span>
                    </div>
                </div>
            </div>
            <div id='area-condition'>
                <label class='label'>您期望代理的区域：</label>
                <span id='area-condition-text' class='select' onclick='checkArea()'>请选择</span>
            </div>
        </div>
        <div id='submit' onclick='submit()'>提交</div>
        <div id='secret-title'>隐私声明</div>
        <div id='secret-content'>
            南京麦豆健康管理有限公司以下简称“麦豆” 麦豆深知个人信息对您而言十分重要，我们会严格守护您的信息安全，以上信息的收集仅用于麦豆内部统计，麦豆将严格遵守中国法律法规和标准，绝不将您的数据用于第三方平台。
        </div>
        <div id='shade' onclick='popupCancel()'>
            <div id='area' onclick='CommonUtils.stopProp()'>
                <div id='area-title'>请选择区域</div>
                <button id='area-cancel' onclick='popupCancel()'>取消</button>
                <button id='area-confirm' onclick='popupConfirm()'>确定</button>
                <div id='area-content'>
                    <div id='area-province'>
                        <!-- 动态添加市 -->
                    </div>
                    <div id='area-city'>
                        <!-- 动态添加区 -->
                    </div>
                </div>
            </div>
        </div>
        <div id='tip'></div>
    </div>
    
    <script src='./src/utils/AddressUtils.js'></script>
    <script src='./src/utils/RegUtils.js'></script>
    <script type='text/javascript'>
        CommonUtils.setHtmlTitle('澜渟');

        $(function() {
            AddressUtils.initProvince(function(datas) {
                initProvince(datas)
            })
        })

        function checkSex(sex) {
            if (sex == 'male') {
                $('#sex-condition').attr('sex', 1)
            } else if (sex == 'female') {
                $('#sex-condition').attr('sex', 2)
            }
            $('#sex-condition').find('img').attr('src', '/src/assets/img/marketing/check-one-no.png')
            $('#sex-condition-radio').children('.'+sex).children('img').attr('src', '/src/assets/img/marketing/check-one-yes.png')
        }

        function checkIdCard(idcard) {
            if (idcard == 'agent') {
                $('#idCard-condition').attr('idcard', 1)
            } else if (idcard == 'shop') {
                $('#idCard-condition').attr('idcard', 2)
            }
            $('#idCard-condition').find('img').attr('src', '/src/assets/img/marketing/check-one-no.png')
            $('#idCard-condition-radio').children('.'+idcard).children('img').attr('src', '/src/assets/img/marketing/check-one-yes.png')
        }

        function checkProduct(product) {
            var $img = $('#product-condition-checkbox').children('.'+product).children('img')
            var isCheck = $img.attr('src').indexOf('check-some-yes.png') > -1
            if (isCheck) {
                $img.attr('src', '/src/assets/img/marketing/check-some-no.png')
            } else {
                $img.attr('src', '/src/assets/img/marketing/check-some-yes.png')
            }
            var productStr = ''
            $('#product-condition-checkbox').children().each(function() {
                if ($(this).children('img').attr('src').indexOf('check-some-yes.png') > -1) {
                    if (productStr.length == 0) {
                        productStr += $(this).attr('value')
                    } else {
                        productStr += ',' + $(this).attr('value')
                    }
                }
            })
            $('#product-condition').attr('product', productStr)
        }

        function submit() {
            Router.jump('marketing/expodealerinfoSuccess')
        }

        function initProvince(datas) {
            for (var i=0; i<datas.length; i++) {
                var $provinceItem = $('<p class="province-item"></p>')
                $provinceItem.attr('code', datas[i].code).text(datas[i].name)
                $provinceItem.click(function() {
                    $('.province-item').removeClass('active')
                    $('.city-item').removeClass('active')
                    $(this).addClass('active')
                    AddressUtils.initCity($(this).attr('code'), function(datas) {
                        initCity(datas)
                    })
                    refreshCheckedArea()
                })
                $('#area-province').append($provinceItem)
            }
        }
        function initCity(datas) {
            $('#area-city').html(null)
            for (var i=0; i<datas.length; i++) {
                var $cityItem = $('<p class="city-item"></p>')
                $cityItem.attr('code', datas[i].code).text(datas[i].name)
                $cityItem.click(function() {
                    $('.city-item').removeClass('active')
                    $(this).addClass('active')
                    refreshCheckedArea()
                })
                $('#area-city').append($cityItem)
            }
        }
        function refreshCheckedArea() {
            var area = $('.province-item.active').text() + ' ' + $('.city-item.active').text()
            $('#area-title').text(area)
        }
        
        function checkArea() {
            $('#shade').css('display', 'block').removeClass('shadeout').addClass('shadein')
            $('#area').removeClass('popdown').addClass('popup')
            document.body.style.overflow = 'hidden'
        }

        function popupCancel() {
            document.body.style.overflow = 'auto'
            $('#area').removeClass('popup').addClass('popdown')
            $('#shade').removeClass('shadein').addClass('shadeout')
            setTimeout(function() {
                $('#shade').css('display', 'none')
            }, 300)
        }
        function popupConfirm() {
            var $areaCondition = $('#area-condition')
            $areaCondition.attr('pro_code', null)
            $areaCondition.attr('city_code', null)
            $areaCondition.attr('pro_code', $('.province-item.active').attr('code'))
            $areaCondition.attr('city_code', $('.city-item.active').attr('code'))
            $('#area-condition-text').text($('.province-item.active').text()+$('.city-item.active').text())
            popupCancel()
        }

        function submit() {
            var name = $('#name-condition').children('.text').val()
            if (CommonUtils.isEmpty(name)) {
                tip('请填写姓名')
                return
            }
            var sex = $('#sex-condition').attr('sex')
            if (CommonUtils.isEmpty(sex)) {
                tip('请选择性别')
                return
            }
            var phone = $('#phone-condition').children('.text').val()
            if (CommonUtils.isEmpty(phone)) {
                tip('请填写手机号码')
                return
            }
            if (!RegUtils.validPhone(phone)) {
                tip('请填写正确的手机号码')
                return
            }
            var company = $('#company-condition').children('.text').val()
            if (CommonUtils.isEmpty(company)) {
                tip('请填写您的公司')
                return
            }
            var idcard = $('#idCard-condition').attr('idcard')
            if (CommonUtils.isEmpty(idcard)) {
                tip('请填写您的身份')
                return
            }
            var business = $('#business-condition').children('.text').val()
            if (CommonUtils.isEmpty(business)) {
                tip('请填写主营业务')
                return
            }
            var product = $('#product-condition').attr('product')
            if (CommonUtils.isEmpty(product)) {
                tip('请选择感兴趣的产品')
                return
            }
            var pro_code = $('#area-condition').attr('pro_code')
            var city_code = $('#area-condition').attr('city_code')
            if (CommonUtils.isEmpty(pro_code)) {
                tip('请选择您期望代理的区域')
                return
            }

            AjaxUtils.ajax({
                header: {
                    REQUESTAPP: 1
                },
                type: 'POST',
                url: request_path.live+'recommon/common/submit-info',
                data: {
                    name: name,
                    sex: sex,
                    phone: phone,
                    company: company,
                    identity: idcard,
                    business: business,
                    product: product,
                    pro_code: pro_code,
                    city_code: city_code
                },
                success: function(result, textStatus, jqXHR) {
                    tip('提交成功', function() {
                        Router.jump('marketing/expodealerinfoSuccess')
                    })
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    
                }
            })
        }

        function tip(content, callback) {
            $('#tip').css('display', 'block').text(content)
            setTimeout(function () {
                $('#tip').css('display', 'none').text(null)
                typeof(callback) == 'function' && callback()
            }, 2000)
        }
    </script>
</body>
</html>